<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper     PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"     
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.xuexibao.teacher.dao.TeacherRechargeDao">
	<select id="loadTeacherRecharge" resultType="TeacherRecharge" parameterType="String">
		<![CDATA[
			select *
			from teacher_recharge 
			where id=#{value}
		 ]]>
	</select>
	
	<select id="getRechargeByTeacherIdStudentId" resultType="TeacherRecharge">
		<![CDATA[
			select *
			from teacher_recharge 
			where student_id=#{userId} and teacher_id=#{teacherId} 
			limit 1
		 ]]>
	</select>

	<select id="listTeacherRecharge" resultType="TeacherRecharge" parameterType="map">
		<![CDATA[
			select *
			from teacher_recharge 
			where id <#{lastId} and teacher_id=#{teacherId}
			order by id desc 
			limit #{pageSize}
		]]>
	</select>

	<select id="countTeacherRecharge" resultType="int" parameterType="TeacherRecharge">
		<![CDATA[
			select count(1)
			from teacher_recharge 
			where id <#{lastId}
		]]>
	</select>

	<insert id="addTeacherRecharge" useGeneratedKeys="true" keyProperty="id"   parameterType="TeacherRecharge">
		insert into
		teacher_recharge(
			teacher_id,
			student_id,
			student_phone_number,
			create_time,
			update_time,
			recharge_money,
			recharge_time,
			income_money
		)
		values(
					#{teacherId},
					#{studentId},
					#{studentPhoneNumber},
					#{createTime},
					#{updateTime},
					#{rechargeMoney},
					#{rechargeTime},
					#{incomeMoney}
		)
	</insert>

	<update id="updateStudentRecharge" parameterType="TeacherRecharge">
		update teacher_recharge 
		set   status=#{status},
              recharge_money=#{rechargeMoney},
              recharge_time=#{rechargeTime},
              income_money=#{incomeMoney}
		where id=#{id}
	</update>

	<delete id="deleteTeacherRecharge" parameterType="String">
		<![CDATA[
			delete 
			from teacher_recharge 
			where id=#{value}
		]]>
	</delete>

	<select id="isExistTeacherRecharge" parameterType="TeacherRecharge" resultType="int">
		<![CDATA[
			select count(1) 
			from teacher_recharge  
			where name=#{name} and id!=#{id}
		]]>
	</select>
</mapper> 